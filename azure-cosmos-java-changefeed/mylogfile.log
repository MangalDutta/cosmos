2022-05-13 16:43:13,865       [main] ERROR fc.azure.cosmos.cfp.CFPApp - ddd
java.lang.IllegalArgumentException: cannot buildAsyncClient client without service endpoint
	at com.azure.cosmos.implementation.AsyncDocumentClient$Builder.ifThrowIllegalArgException(AsyncDocumentClient.java:215)
	at com.azure.cosmos.implementation.AsyncDocumentClient$Builder.build(AsyncDocumentClient.java:221)
	at com.azure.cosmos.CosmosAsyncClient.<init>(CosmosAsyncClient.java:127)
	at com.azure.cosmos.CosmosClientBuilder.buildAsyncClient(CosmosClientBuilder.java:762)
	at fc.azure.cosmos.cfp.CFPApp.getCosmosClient(CFPApp.java:163)
	at fc.azure.cosmos.cfp.CFPApp.initChangeFeedProcessor(CFPApp.java:62)
	at fc.azure.cosmos.cfp.CFPApp.main(CFPApp.java:49)
2022-05-13 17:28:25,487       [main] INFO  com.azure.cosmos.implementation.RxDocumentClientImpl - Initializing DocumentClient [0] with serviceEndpoint [https://mongorand1.mongo.cosmos.azure.com:443/], connectionPolicy [ConnectionPolicy{httpNetworkRequestTimeout=null, tcpNetworkRequestTimeout=PT5S, connectionMode=DIRECT, maxConnectionPoolSize=1000, idleHttpConnectionTimeout=null, idleTcpConnectionTimeout=PT0S, userAgentSuffix='CosmosDBServiceCFP', throttlingRetryOptions=RetryOptions{maxRetryAttemptsOnThrottledRequests=9, maxRetryWaitTime=PT30S}, endpointDiscoveryEnabled=true, preferredRegions=null, multipleWriteRegionsEnabled=true, proxyType=null, inetSocketProxyAddress=null, readRequestsFallbackEnabled=true, connectTimeout=PT5S, idleTcpEndpointTimeout=PT1H, maxConnectionsPerEndpoint=130, maxRequestsPerConnection=30, tcpConnectionEndpointRediscoveryEnabled=false, clientTelemetryEnabled=false}], consistencyLevel [Session], directModeProtocol [Tcp]
2022-05-13 17:28:25,829       [cosmos-parallel-1] INFO  com.azure.cosmos.implementation.RxDocumentClientImpl - Getting database account endpoint from https://mongorand1.mongo.cosmos.azure.com:443/
2022-05-13 17:28:28,469       [reactor-http-nio-1] WARN  com.azure.cosmos.implementation.RxDocumentClientImpl - Failed to retrieve database account information. {"ClassName":"CosmosException","userAgent":"azsdk-java-cosmos/4.25.0 Windows11/10.0 JRE/1.8.0_321","statusCode":404,"resourceAddress":"https://mongorand1.mongo.cosmos.azure.com:443/","error":"{\"code\":\"NotFound\",\"message\":\"null, StatusCode: NotFound\",\"additionalErrorInfo\":null}","innerErrorMessage":"null, StatusCode: NotFound","causeInfo":null,"responseHeaders":"{content-length=0, Date=Fri, 13 May 2022 11:58:27 GMT}","requestHeaders":"[Accept=application/json, x-ms-date=Fri, 13 May 2022 11:58:25 GMT]","cosmosDiagnostics":{"userAgent":"azsdk-java-cosmos/4.25.0 Windows11/10.0 JRE/1.8.0_321","activityId":null,"requestLatencyInMs":2454,"requestStartTimeUTC":"2022-05-13T11:58:25.931Z","requestEndTimeUTC":"2022-05-13T11:58:28.385Z","responseStatisticsList":[],"supplementalResponseStatisticsList":[],"addressResolutionStatistics":{},"regionsContacted":[],"retryContext":{"statusAndSubStatusCodes":null,"retryLatency":0,"retryCount":0},"metadataDiagnosticsContext":{"metadataDiagnosticList":null},"serializationDiagnosticsContext":{"serializationDiagnosticsList":null},"gatewayStatistics":{"sessionToken":null,"operationType":"Read","resourceType":"DatabaseAccount","statusCode":404,"subStatusCode":0,"requestCharge":"0.0","requestTimeline":[{"eventName":"connectionCreated","startTimeUTC":"2022-05-13T11:58:25.938Z","durationInMicroSec":2102000},{"eventName":"connectionConfigured","startTimeUTC":"2022-05-13T11:58:28.040Z","durationInMicroSec":28000},{"eventName":"requestSent","startTimeUTC":"2022-05-13T11:58:28.068Z","durationInMicroSec":20000},{"eventName":"transitTime","startTimeUTC":"2022-05-13T11:58:28.088Z","durationInMicroSec":236000},{"eventName":"received","startTimeUTC":"2022-05-13T11:58:28.324Z","durationInMicroSec":37000}],"partitionKeyRangeId":null},"systemInformation":{"usedMemory":"66732 KB","availableMemory":"7297364 KB","systemCpuLoad":"empty","availableProcessors":8},"clientCfgs":{"id":0,"connectionMode":"DIRECT","numberOfClients":1,"connCfg":{"rntbd":null,"gw":"(cps:1000, nrto:null, icto:null, p:false)","other":"(ed: true, cs: false)"},"consistencyCfg":"(consistency: Session, mm: true, prgns: [])"}}}
2022-05-13 17:28:28,470       [reactor-http-nio-1] ERROR com.azure.cosmos.implementation.GlobalEndpointManager - Fail to reach global gateway [https://mongorand1.mongo.cosmos.azure.com:443/], [{"innerErrorMessage":"null, StatusCode: NotFound","cosmosDiagnostics":{"userAgent":"azsdk-java-cosmos/4.25.0 Windows11/10.0 JRE/1.8.0_321","activityId":null,"requestLatencyInMs":2454,"requestStartTimeUTC":"2022-05-13T11:58:25.931Z","requestEndTimeUTC":"2022-05-13T11:58:28.385Z","responseStatisticsList":[],"supplementalResponseStatisticsList":[],"addressResolutionStatistics":{},"regionsContacted":[],"retryContext":{"statusAndSubStatusCodes":null,"retryLatency":0,"retryCount":0},"metadataDiagnosticsContext":{"metadataDiagnosticList":null},"serializationDiagnosticsContext":{"serializationDiagnosticsList":null},"gatewayStatistics":{"sessionToken":null,"operationType":"Read","resourceType":"DatabaseAccount","statusCode":404,"subStatusCode":0,"requestCharge":"0.0","requestTimeline":[{"eventName":"connectionCreated","startTimeUTC":"2022-05-13T11:58:25.938Z","durationInMicroSec":2102000},{"eventName":"connectionConfigured","startTimeUTC":"2022-05-13T11:58:28.040Z","durationInMicroSec":28000},{"eventName":"requestSent","startTimeUTC":"2022-05-13T11:58:28.068Z","durationInMicroSec":20000},{"eventName":"transitTime","startTimeUTC":"2022-05-13T11:58:28.088Z","durationInMicroSec":236000},{"eventName":"received","startTimeUTC":"2022-05-13T11:58:28.324Z","durationInMicroSec":37000}],"partitionKeyRangeId":null},"systemInformation":{"usedMemory":"66732 KB","availableMemory":"7297364 KB","systemCpuLoad":"empty","availableProcessors":8},"clientCfgs":{"id":0,"connectionMode":"DIRECT","numberOfClients":1,"connCfg":{"rntbd":null,"gw":"(cps:1000, nrto:null, icto:null, p:false)","other":"(ed: true, cs: false)"},"consistencyCfg":"(consistency: Session, mm: true, prgns: [])"}}}]
2022-05-13 17:28:28,471       [reactor-http-nio-1] ERROR com.azure.cosmos.implementation.GlobalEndpointManager - startRefreshLocationTimerAsync() - Unable to refresh database account from any location. Exception: {"ClassName":"CosmosException","userAgent":"azsdk-java-cosmos/4.25.0 Windows11/10.0 JRE/1.8.0_321","statusCode":404,"resourceAddress":"https://mongorand1.mongo.cosmos.azure.com:443/","error":"{\"code\":\"NotFound\",\"message\":\"null, StatusCode: NotFound\",\"additionalErrorInfo\":null}","innerErrorMessage":"null, StatusCode: NotFound","causeInfo":null,"responseHeaders":"{content-length=0, Date=Fri, 13 May 2022 11:58:27 GMT}","requestHeaders":"[Accept=application/json, x-ms-date=Fri, 13 May 2022 11:58:25 GMT]","cosmosDiagnostics":{"userAgent":"azsdk-java-cosmos/4.25.0 Windows11/10.0 JRE/1.8.0_321","activityId":null,"requestLatencyInMs":2454,"requestStartTimeUTC":"2022-05-13T11:58:25.931Z","requestEndTimeUTC":"2022-05-13T11:58:28.385Z","responseStatisticsList":[],"supplementalResponseStatisticsList":[],"addressResolutionStatistics":{},"regionsContacted":[],"retryContext":{"statusAndSubStatusCodes":null,"retryLatency":0,"retryCount":0},"metadataDiagnosticsContext":{"metadataDiagnosticList":null},"serializationDiagnosticsContext":{"serializationDiagnosticsList":null},"gatewayStatistics":{"sessionToken":null,"operationType":"Read","resourceType":"DatabaseAccount","statusCode":404,"subStatusCode":0,"requestCharge":"0.0","requestTimeline":[{"eventName":"connectionCreated","startTimeUTC":"2022-05-13T11:58:25.938Z","durationInMicroSec":2102000},{"eventName":"connectionConfigured","startTimeUTC":"2022-05-13T11:58:28.040Z","durationInMicroSec":28000},{"eventName":"requestSent","startTimeUTC":"2022-05-13T11:58:28.068Z","durationInMicroSec":20000},{"eventName":"transitTime","startTimeUTC":"2022-05-13T11:58:28.088Z","durationInMicroSec":236000},{"eventName":"received","startTimeUTC":"2022-05-13T11:58:28.324Z","durationInMicroSec":37000}],"partitionKeyRangeId":null},"systemInformation":{"usedMemory":"66732 KB","availableMemory":"7297364 KB","systemCpuLoad":"empty","availableProcessors":8},"clientCfgs":{"id":0,"connectionMode":"DIRECT","numberOfClients":1,"connCfg":{"rntbd":null,"gw":"(cps:1000, nrto:null, icto:null, p:false)","other":"(ed: true, cs: false)"},"consistencyCfg":"(consistency: Session, mm: true, prgns: [])"}}}
{"ClassName":"CosmosException","userAgent":"azsdk-java-cosmos/4.25.0 Windows11/10.0 JRE/1.8.0_321","statusCode":404,"resourceAddress":"https://mongorand1.mongo.cosmos.azure.com:443/","error":"{\"code\":\"NotFound\",\"message\":\"null, StatusCode: NotFound\",\"additionalErrorInfo\":null}","innerErrorMessage":"null, StatusCode: NotFound","causeInfo":null,"responseHeaders":"{content-length=0, Date=Fri, 13 May 2022 11:58:27 GMT}","requestHeaders":"[Accept=application/json, x-ms-date=Fri, 13 May 2022 11:58:25 GMT]","cosmosDiagnostics":{"userAgent":"azsdk-java-cosmos/4.25.0 Windows11/10.0 JRE/1.8.0_321","activityId":null,"requestLatencyInMs":2454,"requestStartTimeUTC":"2022-05-13T11:58:25.931Z","requestEndTimeUTC":"2022-05-13T11:58:28.385Z","responseStatisticsList":[],"supplementalResponseStatisticsList":[],"addressResolutionStatistics":{},"regionsContacted":[],"retryContext":{"statusAndSubStatusCodes":null,"retryLatency":0,"retryCount":0},"metadataDiagnosticsContext":{"metadataDiagnosticList":null},"serializationDiagnosticsContext":{"serializationDiagnosticsList":null},"gatewayStatistics":{"sessionToken":null,"operationType":"Read","resourceType":"DatabaseAccount","statusCode":404,"subStatusCode":0,"requestCharge":"0.0","requestTimeline":[{"eventName":"connectionCreated","startTimeUTC":"2022-05-13T11:58:25.938Z","durationInMicroSec":2102000},{"eventName":"connectionConfigured","startTimeUTC":"2022-05-13T11:58:28.040Z","durationInMicroSec":28000},{"eventName":"requestSent","startTimeUTC":"2022-05-13T11:58:28.068Z","durationInMicroSec":20000},{"eventName":"transitTime","startTimeUTC":"2022-05-13T11:58:28.088Z","durationInMicroSec":236000},{"eventName":"received","startTimeUTC":"2022-05-13T11:58:28.324Z","durationInMicroSec":37000}],"partitionKeyRangeId":null},"systemInformation":{"usedMemory":"66732 KB","availableMemory":"7297364 KB","systemCpuLoad":"empty","availableProcessors":8},"clientCfgs":{"id":0,"connectionMode":"DIRECT","numberOfClients":1,"connCfg":{"rntbd":null,"gw":"(cps:1000, nrto:null, icto:null, p:false)","other":"(ed: true, cs: false)"},"consistencyCfg":"(consistency: Session, mm: true, prgns: [])"}}}
	at com.azure.cosmos.BridgeInternal.createCosmosException(BridgeInternal.java:474)
	at com.azure.cosmos.implementation.RxGatewayStoreModel.validateOrThrow(RxGatewayStoreModel.java:440)
	at com.azure.cosmos.implementation.RxGatewayStoreModel.lambda$toDocumentServiceResponse$0(RxGatewayStoreModel.java:347)
	at reactor.core.publisher.FluxMap$MapSubscriber.onNext(FluxMap.java:106)
	at reactor.core.publisher.FluxSwitchIfEmpty$SwitchIfEmptySubscriber.onNext(FluxSwitchIfEmpty.java:74)
	at reactor.core.publisher.Operators$ScalarSubscription.request(Operators.java:2398)
	at reactor.core.publisher.Operators$MultiSubscriptionSubscriber.set(Operators.java:2194)
	at reactor.core.publisher.Operators$MultiSubscriptionSubscriber.onSubscribe(Operators.java:2068)
	at reactor.core.publisher.MonoJust.subscribe(MonoJust.java:55)
	at reactor.core.publisher.Mono.subscribe(Mono.java:4400)
	at reactor.core.publisher.FluxSwitchIfEmpty$SwitchIfEmptySubscriber.onComplete(FluxSwitchIfEmpty.java:82)
	at reactor.core.publisher.FluxPeek$PeekSubscriber.onComplete(FluxPeek.java:260)
	at reactor.core.publisher.FluxHandle$HandleSubscriber.onComplete(FluxHandle.java:213)
	at reactor.core.publisher.FluxMap$MapConditionalSubscriber.onComplete(FluxMap.java:269)
	at reactor.core.publisher.FluxDoFinally$DoFinallySubscriber.onComplete(FluxDoFinally.java:145)
	at reactor.core.publisher.FluxHandleFuseable$HandleFuseableSubscriber.onNext(FluxHandleFuseable.java:201)
	at reactor.core.publisher.FluxContextWrite$ContextWriteSubscriber.onNext(FluxContextWrite.java:107)
	at reactor.core.publisher.Operators$MonoSubscriber.complete(Operators.java:1816)
	at reactor.core.publisher.MonoCollectList$MonoCollectListSubscriber.onComplete(MonoCollectList.java:128)
	at reactor.core.publisher.FluxPeek$PeekSubscriber.onComplete(FluxPeek.java:260)
	at reactor.core.publisher.FluxMap$MapSubscriber.onComplete(FluxMap.java:142)
	at reactor.netty.channel.FluxReceive.onInboundComplete(FluxReceive.java:400)
	at reactor.netty.channel.ChannelOperations.onInboundComplete(ChannelOperations.java:419)
	at reactor.netty.channel.ChannelOperations.terminate(ChannelOperations.java:473)
	at reactor.netty.http.client.HttpClientOperations.onInboundNext(HttpClientOperations.java:702)
	at reactor.netty.channel.ChannelOperationsHandler.channelRead(ChannelOperationsHandler.java:93)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357)
	at io.netty.handler.timeout.IdleStateHandler.channelRead(IdleStateHandler.java:286)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357)
	at io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436)
	at io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:324)
	at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:296)
	at io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357)
	at io.netty.handler.ssl.SslHandler.unwrap(SslHandler.java:1371)
	at io.netty.handler.ssl.SslHandler.decodeNonJdkCompatible(SslHandler.java:1245)
	at io.netty.handler.ssl.SslHandler.decode(SslHandler.java:1285)
	at io.netty.handler.codec.ByteToMessageDecoder.decodeRemovalReentryProtection(ByteToMessageDecoder.java:507)
	at io.netty.handler.codec.ByteToMessageDecoder.callDecode(ByteToMessageDecoder.java:446)
	at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:276)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:166)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:722)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:658)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:584)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:750)
2022-05-13 17:28:28,476       [main] ERROR com.azure.cosmos.implementation.RxDocumentClientImpl - Client initialization failed. Check if the endpoint is reachable and if your auth token is valid. More info: https://aka.ms/cosmosdb-tsg-service-unavailable-java
2022-05-13 17:28:28,476       [main] ERROR com.azure.cosmos.implementation.RxDocumentClientImpl - unexpected failure in initializing client.
java.lang.RuntimeException: Client initialization failed. Check if the endpoint is reachable and if your auth token is valid. More info: https://aka.ms/cosmosdb-tsg-service-unavailable-java
	at com.azure.cosmos.implementation.RxDocumentClientImpl.initializeGatewayConfigurationReader(RxDocumentClientImpl.java:401)
	at com.azure.cosmos.implementation.RxDocumentClientImpl.init(RxDocumentClientImpl.java:436)
	at com.azure.cosmos.implementation.AsyncDocumentClient$Builder.build(AsyncDocumentClient.java:245)
	at com.azure.cosmos.CosmosAsyncClient.<init>(CosmosAsyncClient.java:127)
	at com.azure.cosmos.CosmosClientBuilder.buildAsyncClient(CosmosClientBuilder.java:762)
	at fc.azure.cosmos.cfp.CFPApp.getCosmosClient(CFPApp.java:163)
	at fc.azure.cosmos.cfp.CFPApp.initChangeFeedProcessor(CFPApp.java:62)
	at fc.azure.cosmos.cfp.CFPApp.main(CFPApp.java:49)
2022-05-13 17:28:28,477       [main] INFO  com.azure.cosmos.implementation.RxDocumentClientImpl - Attempting to close client 0
2022-05-13 17:28:28,477       [main] INFO  com.azure.cosmos.implementation.RxDocumentClientImpl - Shutting down ...
2022-05-13 17:28:28,477       [main] INFO  com.azure.cosmos.implementation.RxDocumentClientImpl - Closing Global Endpoint Manager ...
2022-05-13 17:28:28,477       [main] INFO  com.azure.cosmos.implementation.RxDocumentClientImpl - Closing StoreClientFactory ...
2022-05-13 17:28:28,477       [main] INFO  com.azure.cosmos.implementation.RxDocumentClientImpl - Shutting down reactorHttpClient ...
2022-05-13 17:28:28,481       [main] INFO  com.azure.cosmos.implementation.RxDocumentClientImpl - Shutting down CpuMonitor ...
2022-05-13 17:28:28,481       [main] INFO  com.azure.cosmos.implementation.RxDocumentClientImpl - Shutting down completed.
2022-05-13 17:28:28,481       [main] ERROR fc.azure.cosmos.cfp.CFPApp - ddd
java.lang.RuntimeException: Client initialization failed. Check if the endpoint is reachable and if your auth token is valid. More info: https://aka.ms/cosmosdb-tsg-service-unavailable-java
	at com.azure.cosmos.implementation.RxDocumentClientImpl.initializeGatewayConfigurationReader(RxDocumentClientImpl.java:401)
	at com.azure.cosmos.implementation.RxDocumentClientImpl.init(RxDocumentClientImpl.java:436)
	at com.azure.cosmos.implementation.AsyncDocumentClient$Builder.build(AsyncDocumentClient.java:245)
	at com.azure.cosmos.CosmosAsyncClient.<init>(CosmosAsyncClient.java:127)
	at com.azure.cosmos.CosmosClientBuilder.buildAsyncClient(CosmosClientBuilder.java:762)
	at fc.azure.cosmos.cfp.CFPApp.getCosmosClient(CFPApp.java:163)
	at fc.azure.cosmos.cfp.CFPApp.initChangeFeedProcessor(CFPApp.java:62)
	at fc.azure.cosmos.cfp.CFPApp.main(CFPApp.java:49)
